# 実験名未定

## plan by nishio

(nishio) logが7件集まったので、人間のプレイを教師データとして学習したい。どのような方法が良いと思うか？

### 目的の確認（最初に決める）

- 人間の意思決定を**再現**するのが目的か（模倣精度重視）
- それとも**勝率を上げる**のが目的か（人間らしさより強さ）

ここでは「人間のプレイを教師データとして学習」に合わせて、**模倣精度を主目標**にしたプランを提案する。

→nishio: 勝率を上げることが目的である、現状の人間もあまり強くはない。
  - 1: 人間から学習したlr1を作る
  - 2: lr1がheiristic2に対して強いかどうかを自己対戦で実験する
  - 3: ログの「勝者/敗者」から学習したlr2を作る
  - 4: これがlr1より強いかどうかを自己対戦で確認する

### 推奨アプローチ

データが7ログと少ないので、複雑な学習よりも**解釈可能で低次元**の手法が良い。

1. **HeuristicParamsの同定（パラメータ学習）**  
   既存の `HeuristicAI` をベースに、閾値・milking・blockingを人間の選択に近づける。
2. **軽量な行動クローン（分類）**  
   1手ごとの TAKE/PASS を教師にしてロジスティック回帰 or 決定木で学習。

まずは1で作業量を抑えつつ、2で「人間が重視している特徴」が見えるようにするのが良い。

(nishio) 同感です。AIプレイヤーの行動のバリエーションを増やすことを考えて、ロジスティック回帰してpredict_probaして確率的に行動決定することを考えている。

### 具体プラン

1. **ログ解析（教師データ化）**
   - 各ログから「人間の意思決定点」を抽出
   - 状態特徴（入力）を作成
     - `Δscore`（take_cost）, tokens_on_card, deck_left, 自分/相手のtokens
     - runの両端にある未公開カード数（自分/相手）　# nishio: これは低コストカードの出現確率と関連している、デッキの残りカード数を掛けたものも追加で特徴量にすべき
     - 相対スコア（自分−最小相手）
     - (追加特徴案 by nishio):
       - 自分がpassして他人が取った時に発生するチップ格差を恐れる気持ち(特に残りデッキ数が多い時に)を表現したい
         - またその時に自分がチップ数でビリになるかどうか
         - チップ数でビリになる人のチップ数
         - チップ数でトップとビリの差
       - トップとの点差
         - 残りデッキで割ったもの
       - 自分が1枚以上カードを取っているか
       - HeuristicParamsのparamが掛け算されている対象
         - HeuristicがLRで再現できるように特徴量に分解すると良い
   - 教師ラベルは TAKE/PASS

2. **ベースライン評価**
   - 既存 heuristic の人間一致率（accuracy）を測る
   - 混同行列（TAKEすべき時にPASSしがち、など）を確認

4. **軽量分類モデル（補助）**
   - ロジスティック回帰
   - 重みの観察

5. **評価**
  - 1: 人間から学習したlr1を作る
  - 2: lr1がheiristic2に対して強いかどうかを自己対戦で実験する
  - 3: ログの「勝者/敗者」から学習したlr2を作る
  - 4: これがlr1より強いかどうかを自己対戦で確認する


### 成果物

- `logs` から教師データを生成するスクリプト
- `lr1`, `lr2`（人間に近いパラメータ）
- 実験レポート（一致率・比較結果）
